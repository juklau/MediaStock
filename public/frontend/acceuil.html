<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MediaStock - Gestion d'inventaire</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <link rel="stylesheet" href="style.css">
    </head>
    <body class="bg-light">
        <!-- Header -->
        <header class="position-relative" style="background-color: #FF9994; height: 60px;">
            <div class="container h-100">
                <div class="row h-100 align-items-center justify-content-center">
                    <div class="col-12 text-center position-relative h-100 d-flex align-items-center justify-content-center">
                        <!-- Logo MediaStock qui colle aux bords -->
                        <div class="position-relative" style="z-index: 2; height: 100%; display: flex; align-items: center; justify-content: center;">
                            <img src="logo.png" alt="MediaStock" 
                                class="img-fluid" style="height: 100%; width: auto; object-fit: contain;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="py-5">
        <div class="container">
            <!-- Login Section -->
            <div class="row justify-content-center mb-5">
                <div class="col-lg-6">
                    <div class="card shadow-lg border-0 rounded-4">
                        <div class="card-body p-5">
                            <h3 class="text-center mb-4" style="color: #FF9994; font-size: 1.2rem; font-weight: 400; text-decoration: underline;">Êtes-vous administrateur ?</h3>

                            <form action="../login.php" method="post" id="loginForm">
                                <div class="mb-4">
                                    <label for="username" class="form-label" style="color: #FF9994; font-weight: 400; text-decoration: underline;">Nom d'utilisateur :</label>
                                    <input type="text" name="username" class="form-control form-control-lg border-0 bg-light rounded-3" 
                                           id="username" placeholder="Entrez votre nom d'utilisateur">
                                </div>
                                
                                <div class="mb-4">
                                    <label for="password" class="form-label" style="color: #FF9994; font-weight: 400; text-decoration: underline;">Mot de passe :</label>
                                    <input type="password" name="password" class="form-control form-control-lg border-0 bg-light rounded-3" 
                                           id="password" placeholder="Entrez votre mot de passe">
                                </div>
                                
                                <form id="loginForm">
                                    <div class="mb-4">
                                        <label for="username" class="form-label" style="color: #FF9994; font-weight: 400; text-decoration: underline;">Nom d'utilisateur :</label>
                                        <input type="text" class="form-control form-control-lg border-0 bg-light rounded-3" 
                                            id="username" placeholder="Entrez votre nom d'utilisateur">
                                    </div>
                                    
                                    <div class="mb-4">
                                        <label for="password" class="form-label" style="color: #FF9994; font-weight: 400; text-decoration: underline;">Mot de passe :</label>
                                        <input type="password" class="form-control form-control-lg border-0 bg-light rounded-3" 
                                            id="password" placeholder="Entrez votre mot de passe">
                                    </div>
                                    
                                    <div class="text-center">
                                        <button type="submit" 
                                        class="btn btn-lg text-white rounded-3 px-5" 
                                        style="background-color: #FF9994; color: #000 !important; font-weight: 400;">
                                        Se Connecter
                                    </button>
                                </div>
                                  
                            </form>

                            <!-- Ajoute SweetAlert2 -->
                            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

                            <script src="../frontend/alert.js"></script>

                        </div>
                    </div>
                </div>

                <!-- Equipment Section -->
                <div class="row">
                    <div class="col-12">
                        <h2 class="text-center mb-5" style="color: #FF9994; text-decoration: underline; font-size: 1.4rem; font-weight: 400;">Matériel disponible :</h2>
                        
                        <div class="row g-4">
                            <!-- Périphérique informatique -->
                            <div class="col-lg-3 col-md-6">
                                <div class="card h-100 shadow-sm border-3 rounded-4 equipment-card">
                                    <div class="card-body text-center p-4">
                                        <div class="mb-3">
                                            <i class="fas fa-mouse text-dark" style="font-size: 3rem; opacity: 0.69;"></i>
                                        </div>
                                        <h5 class="card-title text-dark mb-2" style="font-weight: 400; opacity: 0.69;">Périphérique informatique</h5>
                                        <div class="display-4 text-dark" style="font-weight: 400; font-size: 2rem; opacity: 0.69;">
                                            <!--Affiche le nombre d'element informatique dynamique depuis la BDD -->
                                            <div id="info-count-informatique"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Périphérique audio -->
                            <div class="col-lg-3 col-md-6">
                                <div class="card h-100 shadow-sm border-3 rounded-4 equipment-card">
                                    <div class="card-body text-center p-4">
                                        <div class="mb-3">
                                            <i class="fas fa-headphones text-dark" style="font-size: 3rem; opacity: 0.69;"></i>
                                        </div>
                                        <h5 class="card-title text-dark mb-2" style="font-weight: 400; opacity: 0.69;">Périphérique audio</h5>
                                        <div class="display-4 text-dark" style="font-weight: 400; font-size: 2rem; opacity: 0.69;">
                                            <!--Affiche le nombre d'element audio dynamique depuis la BDD -->
                                            <div id="info-count-audio"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Connectiques -->
                            <div class="col-lg-3 col-md-6">
                                <div class="card h-100 shadow-sm border-3 rounded-4 equipment-card">
                                    <div class="card-body text-center p-4">
                                        <div class="mb-3">
                                            <i class="fas fa-plug text-dark" style="font-size: 3rem; opacity: 0.69;"></i>
                                        </div>
                                        <h5 class="card-title text-dark mb-2" style="font-weight: 400; opacity: 0.69;">Connectiques</h5>
                                        <div class="display-4 text-dark" style="font-weight: 400; font-size: 2rem; opacity: 0.69;">
                                            <!--Affiche le nombre d'element connectique dynamique depuis la BDD -->
                                            <div id="info-count-connectique"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Autres -->
                            <div class="col-lg-3 col-md-6">
                                <div class="card h-100 shadow-sm border-3 rounded-4 equipment-card">
                                    <div class="card-body text-center p-4">
                                        <div class="mb-3">
                                            <i class="fas fa-server text-dark" style="font-size: 3rem; opacity: 0.69;"></i>
                                        </div>
                                        <h5 class="card-title text-dark mb-2" style="font-weight: 400; opacity: 0.69;">Autres</h5>
                                        <div class="display-4 text-dark" style="font-weight: 400; font-size: 2rem; opacity: 0.69;">
                                            <!--Affiche le nombre d'element autres dynamique depuis la BDD -->
                                            <div id="info-count-autres"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="py-4" style="background-color: #FF9994;">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p class="mb-0 text-dark" style="font-weight: 400; opacity: 0.69;">Mentions légales</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <p class="mb-0 text-dark" style="font-weight: 400; opacity: 0.69;">© 2025 MediaStock inc</p>
                    </div>
                </div>
            </div>
        </footer>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <!-- <script>
            fetch('/../api/getnbdispoparcat.php')
                .then(response => response.json())
                .then(data => {
                    const categorie = data.find(item => item.categorie === "Informatique");
                    if (categorie) {
                        const element = document.createElement('div');
                        element.textContent = `${categorie.disponible_count}`;
                        const target = document.getElementById('info-count-informatique');
                        if (target) {
                            target.appendChild(element);
                        }
                    } else {
                        console.error("Catégorie non trouvée !");
                    }
                })
                .catch(error => console.error('Erreur:', error));
        </script>
        <script>
            fetch('/../api/getnbdispoparcat.php')
                .then(response => response.json())
                .then(data => {
                    const categorie = data.find(item => item.categorie === "Audio");
                    if (categorie) {
                        const element = document.createElement('div');
                        element.textContent = `${categorie.disponible_count}`;
                        const target = document.getElementById('info-count-audio');
                        if (target) {
                            target.appendChild(element);
                        }
                    } else {
                        console.error("Catégorie non trouvée !");
                    }
                })
                .catch(error => console.error('Erreur:', error));
        </script>
        <script>
            fetch('/../api/getnbdispoparcat.php')
                .then(response => response.json())
                .then(data => {
                    const categorie = data.find(item => item.categorie === "Connectique");
                    if (categorie) {
                        const element = document.createElement('div');
                        element.textContent = `${categorie.disponible_count}`;
                        const target = document.getElementById('info-count-connectique');
                        if (target) {
                            target.appendChild(element);
                        }
                    } else {
                        console.error("Catégorie non trouvée !");
                    }
                })
                .catch(error => console.error('Erreur:', error));
        </script>
        <script>
            fetch('/../api/getnbdispoparcat.php')
                .then(response => response.json())
                .then(data => {
                    const categorie = data.find(item => item.categorie === "Autres");
                    if (categorie) {
                        const element = document.createElement('div');
                        element.textContent = `${categorie.disponible_count}`;
                        const target = document.getElementById('info-count-autres');
                        if (target) {
                            target.appendChild(element);
                        }
                    } else {
                        console.error("Catégorie non trouvée !");
                    }
                })
                .catch(error => console.error('Erreur:', error));
        </script> -->


        <!-- afficher dynamiquement le nombre d'articles disponibles par catégorie dans ton interface -->
        <script>

            //lancer une requête HTTP GET => reponse en json
            fetch('/../api/getnbdispoparcat.php')

            // convertir la réponse en objet JS => p.ex.: [{ categorie: "Informatique", disponible_count: 12 },..]
            .then(response => response.json())
                .then(data => {
                    const categories = { //dictionnaire => nomm : id
                        "Informatique": "info-count-informatique",
                        "Audio": "info-count-audio",
                        "Connectique": "info-count-connectique",
                        "Autres": "info-count-autres"
                    };

                    // parcourir le data (dictionnaire)
                    for (const [nom, id] of Object.entries(categories)) {

                        const cat = data.find(item => item.categorie === nom);
                        
                        if (cat) {

                            //création un div
                            const element = document.createElement('div');

                            //remplirle div avec le nb d'articles disponibles
                            element.textContent = `${cat.disponible_count}`;
                            
                            
                            const target = document.getElementById(id);
                            if (target) {
                                target.appendChild(element);
                            };
                        }
                        // sinon => rien est affiché pour catégorie
                    }
                })
                .catch(error => console.error('Erreur:', error));

        </script>

    </body>
</html>
